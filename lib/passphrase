_read_passphrase() {
  prompt="${1:-Enter passphrase}"
  var="${2:-PASSPHRASE}"
  read -rsp "$prompt" "$var" && echo
}

_new_passphrase() {
  _read_passphrase 'Enter passphrase: '
  if [[ -z "${PASSPHRASE}" ]]; then
    return 1
  fi

  _read_passphrase 'Confirm passphrase: ' PASSPHRASE_CONFIRMATION
  if [[ "${PASSPHRASE}" != "${PASSPHRASE_CONFIRMATION}" ]]; then
    return 2
  fi
}
